import{r as P,c as B,h as j,z as T,A as d,B as l,I as u,L as v,K as D,R as e,J as t,al as n,S as E,u as s,P as b,E as m,aB as G,O as i,T as Q,M as U}from"./vendor-CVfcT1hl.js";import{m as h,u as $,e as W,f as X,s as z,b as N,r as Y,E as g}from"./elementPlus-ZBiduQnq.js";import{u as Z}from"./index-DdU4QHiA.js";import{u as ee,a as te}from"./routes-CamlQmG2.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";const oe={class:"layout-container"},ae={class:"sidebar-header"},le={class:"logo"},ne={class:"logo-text"},re={class:"sidebar-nav"},de={class:"sidebar-footer"},ue={class:"status-indicator"},ie={class:"status-item"},ce={class:"status-text"},_e={key:0,class:"status-item"},me={class:"status-text"},pe={class:"main-container"},fe={class:"header"},ye={class:"header-left"},ve={class:"header-right"},be={class:"user-info"},he={class:"content"},ge={__name:"Layout",setup(we){const V=G(),o=Z();ee(),te();const p=P(!1);B(()=>o.isSystemHealthy?"text-success":"text-danger");const A=B(()=>o.isSystemHealthy?"系统正常":"系统异常"),H=async()=>{p.value=!0;try{await o.fetchSystemStatus(),g.success("数据已刷新")}catch{g.error("刷新失败")}finally{p.value=!1}},I=()=>{localStorage.removeItem("token"),V.push("/login"),g.success("已退出登录")};return j(async()=>{await o.initializeSystem()}),(c,a)=>{const w=n("Connection"),r=n("el-icon"),C=n("el-menu-item"),L=n("el-menu"),M=n("el-badge"),f=n("el-button"),S=n("el-breadcrumb-item"),R=n("el-breadcrumb"),_=n("el-dropdown-item"),k=n("el-dropdown-menu"),x=n("el-dropdown"),q=n("el-avatar"),F=n("ArrowDown"),J=n("SwitchButton"),K=n("router-view"),O=n("el-alert");return d(),T("div",oe,[l("aside",{class:m(["sidebar",{"sidebar-collapsed":s(o).sidebarCollapsed}])},[l("div",ae,[l("div",le,[e(r,{class:"logo-icon"},{default:t(()=>[e(w)]),_:1}),D(l("span",ne,"Tunnel Flow",512),[[E,!s(o).sidebarCollapsed]])])]),l("nav",re,[e(L,{"default-active":c.$route.path,collapse:s(o).sidebarCollapsed,"unique-opened":!0,router:"",class:"sidebar-menu"},{default:t(()=>[e(C,{index:"/clients"},{title:t(()=>[...a[2]||(a[2]=[i("客户端管理",-1)])]),default:t(()=>[e(r,null,{default:t(()=>[e(s(h))]),_:1})]),_:1}),e(C,{index:"/routes"},{title:t(()=>[...a[3]||(a[3]=[i("路由管理",-1)])]),default:t(()=>[e(r,null,{default:t(()=>[e(w)]),_:1})]),_:1})]),_:1},8,["default-active","collapse"])]),D(l("div",de,[l("div",ue,[l("div",ie,[e(M,{"is-dot":"",type:s(o).isSystemHealthy?"success":"danger",class:"status-badge"},null,8,["type"]),l("span",ce,b(A.value),1)]),s(o).connectedClientsCount>0?(d(),T("div",_e,[e(r,{class:"status-icon text-success"},{default:t(()=>[e(s($))]),_:1}),l("span",me,b(s(o).connectedClientsCount)+" 个客户端",1)])):v("",!0)])],512),[[E,!s(o).sidebarCollapsed]])],2),l("div",pe,[l("header",fe,[l("div",ye,[e(f,{type:"text",onClick:a[0]||(a[0]=y=>s(o).toggleSidebar()),class:"sidebar-toggle"},{default:t(()=>[e(r,null,{default:t(()=>[s(o).sidebarCollapsed?(d(),u(s(W),{key:0})):(d(),u(s(X),{key:1}))]),_:1})]),_:1}),e(R,{separator:"/",class:"breadcrumb"},{default:t(()=>[e(S,{to:{path:"/"}},{default:t(()=>[...a[4]||(a[4]=[i("首页",-1)])]),_:1}),c.$route.meta.title?(d(),u(S,{key:0},{default:t(()=>[i(b(c.$route.meta.title),1)]),_:1})):v("",!0)]),_:1})]),l("div",ve,[e(x,{class:"theme-dropdown",onCommand:s(o).setTheme},{dropdown:t(()=>[e(k,null,{default:t(()=>[e(_,{command:"light",class:m({"is-active":s(o).theme==="light"})},{default:t(()=>[e(r,null,{default:t(()=>[e(s(z))]),_:1}),a[5]||(a[5]=i(" 明亮模式 ",-1))]),_:1},8,["class"]),e(_,{command:"dark",class:m({"is-active":s(o).theme==="dark"})},{default:t(()=>[e(r,null,{default:t(()=>[e(s(N))]),_:1}),a[6]||(a[6]=i(" 黑暗模式 ",-1))]),_:1},8,["class"]),e(_,{command:"system",class:m({"is-active":s(o).theme==="system"})},{default:t(()=>[e(r,null,{default:t(()=>[e(s(h))]),_:1}),a[7]||(a[7]=i(" 跟随系统 ",-1))]),_:1},8,["class"])]),_:1})]),default:t(()=>[e(f,{type:"text",class:"theme-toggle"},{default:t(()=>[e(r,null,{default:t(()=>[s(o).theme==="system"?(d(),u(s(h),{key:0})):s(o).actualTheme==="light"?(d(),u(s(z),{key:1})):(d(),u(s(N),{key:2}))]),_:1})]),_:1})]),_:1},8,["onCommand"]),e(f,{type:"text",onClick:H,loading:p.value,class:"refresh-btn"},{default:t(()=>[e(r,null,{default:t(()=>[e(s(Y))]),_:1})]),_:1},8,["loading"]),e(x,{class:"user-dropdown"},{dropdown:t(()=>[e(k,null,{default:t(()=>[e(_,{onClick:I},{default:t(()=>[e(r,null,{default:t(()=>[e(J)]),_:1}),a[9]||(a[9]=i(" 退出登录 ",-1))]),_:1})]),_:1})]),default:t(()=>[l("div",be,[e(q,{size:32,class:"user-avatar"},{default:t(()=>[e(r,null,{default:t(()=>[e(s($))]),_:1})]),_:1}),a[8]||(a[8]=l("span",{class:"username"},"管理员",-1)),e(r,{class:"dropdown-icon"},{default:t(()=>[e(F)]),_:1})])]),_:1})])]),l("main",he,[e(K,null,{default:t(({Component:y})=>[e(Q,{name:"fade",mode:"out-in"},{default:t(()=>[(d(),u(U(y)))]),_:2},1024)]),_:1})])]),s(o).error?(d(),u(O,{key:0,title:s(o).error,type:"error",closable:!0,onClose:a[1]||(a[1]=y=>s(o).clearError()),class:"global-error"},null,8,["title"])):v("",!0)])}}},Te=se(ge,[["__scopeId","data-v-b6aad162"]]);export{Te as default};
